-- ****** PROGRAMA DE CREACION DE LA BASE DE DATOS TrascorTarde ********
-- ****************************************************************
-- ****** SALVADOR PEREZ SEPTIEMBRE 2021
-- ****************************************************************

-- ********** Nos conectamos a MySQL                 **************
-- ********** Borramos, si existe, una base de datos anterior *****
DROP DATABASE IF EXISTS TrascorTarde;

-- ********** Creamos la base de datos llamada TrascorTarde ************
CREATE DATABASE TrascorTarde
CHARACTER SET utf8
COLLATE utf8_spanish_ci;

-- ****** INICIAMOS SESIÓN EN LA BASE DE DATOS RECIEN CREADA ******
USE TrascorTarde;


-- ****** CREACION DE LAS TABLAS ********
-- *************************************
-- ** SOLO SE CREAN LAS RESTRICCIONES DE CLAVE PRIMARIA **

CREATE TABLE IF NOT EXISTS TCENTR( 
	NUMCE INT(5) NOT NULL AUTO_INCREMENT,
    NOMCE VARCHAR(30) NOT NULL,
    DIRCE VARCHAR(30) NOT NULL,
    CONSTRAINT CP_TCENTR_NUMCE PRIMARY KEY (NUMCE)
)ENGINE InnoDB;

CREATE TABLE IF NOT EXISTS TDEPTO(
	NUMDE INT(5) NOT NULL AUTO_INCREMENT,
    NUMCE INT(5),
    DIREC INT(5),
    TIDIR CHAR(1),
    PRESU DECIMAL(10,2),
    DEPDE INT(5),
    NOMDE VARCHAR(25),
    CONSTRAINT CP_TDEPTO_NUMDE PRIMARY KEY (NUMDE)
)ENGINE InnoDB;

CREATE TABLE IF NOT EXISTS TEMPLE(
	NUMEM INT(5) NOT NULL AUTO_INCREMENT,
    NUMDE INT(5),
    EXTEL INT(5),
    FECNA DATETIME,
    FECIN DATETIME,
    SALAR DECIMAL(8,2),
    COMIS DECIMAL(8,2),
    NUMHI INT(5),
    NOMEM VARCHAR(30),
    CONSTRAINT CP_TEMPLE_NUMEM PRIMARY KEY (NUMEM)
)ENGINE InnoDB;


/*Claves foráneas*/
ALTER TABLE TEMPLE ADD CONSTRAINT FK1_TEMPLE 
	FOREIGN KEY(numde) REFERENCES TDEPTO(numde);
	
ALTER TABLE TDEPTO ADD CONSTRAINT FK1_TDEPTO
	FOREIGN KEY(depde) REFERENCES TDEPTO(numde);

ALTER TABLE TDEPTO ADD CONSTRAINT FK2_TDEPTO
	FOREIGN KEY(numce) REFERENCES TCENTR(numce);

-- ****** INSERCION DE TUPLAS *********
-- ************************************


-- ****** EN TCENTR ********

INSERT INTO TCENTR (NOMCE, DIRCE) VALUES ('SEDE CENTRAL', 'C. ALCALA, 820, MADRID');
INSERT INTO TCENTR (NOMCE, DIRCE) VALUES ('RELACIÓN CON CLIENTES', 'C. ATOCHA, 405, MADRID');


-- ****** EN TDEPTO ********

INSERT INTO TDEPTO (NUMCE,DIREC, TIDIR, PRESU, DEPDE, NOMDE) VALUES (1, 11,'P', 72000, NULL, 'DIRECCIÓN GENERAL');
INSERT INTO TDEPTO (NUMCE,DIREC, TIDIR, PRESU, DEPDE, NOMDE) VALUES (2, 6,'P', 90000, 1, 'DIRECCIÓN COMERCIAL');
INSERT INTO TDEPTO (NUMCE,DIREC, TIDIR, PRESU, DEPDE, NOMDE) VALUES (2, 6,'F', 66000, 2, 'SECTOR INDUSTRIAL');
INSERT INTO TDEPTO (NUMCE,DIREC, TIDIR, PRESU, DEPDE, NOMDE) VALUES (2, 12,'P', 54000, 2, 'SECTOR SERVICIOS');
INSERT INTO TDEPTO (NUMCE,DIREC, TIDIR, PRESU, DEPDE, NOMDE) VALUES (1, 4,'F', 18000, 1, 'ORGANIZACIÓN');
INSERT INTO TDEPTO (NUMCE,DIREC, TIDIR, PRESU, DEPDE, NOMDE) VALUES (1, 4,'P', 12000, 5, 'PERSONAL');
INSERT INTO TDEPTO (NUMCE,DIREC, TIDIR, PRESU, DEPDE, NOMDE) VALUES (1, 20,'P', 36000, 5, 'PROCESO DE DATOS');
INSERT INTO TDEPTO (NUMCE,DIREC, TIDIR, PRESU, DEPDE, NOMDE) VALUES (1, 16,'P', 12000, 1, 'FINANZAS');


-- ****** EN TEMPLE ********

INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (6, 350, '1947-01-12', '1965-02-12', 1863, NULL, 3, 'PONS, CESAR');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (4, 840, '1948-06-10', '1981-10-03', 2104, 661 , 1, 'LASA, MARIO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (4, 810, '1958-09-11', '1982-02-03', 1743, 661 , 2, 'TEROL, LUCIANO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (6, 340, '1948-08-12', '1969-01-16', 2644, NULL, 0, 'PEREZ, JULIO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (3, 740, '1952-07-10', '1981-11-13', 1863, 661 , 2, 'AGUIRRE, AUREO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (2, 508, '1947-10-20', '1969-03-20', 2885, 301 , 2, 'PEREZ, MARCOS');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (6, 350, '1945-05-14', '1975-02-13', 1803, NULL, 4, 'VEIGA, JULIANA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (1, 200, '1953-09-30', '1972-01-24', 2284, NULL, 2, 'GALVEZ, PILAR');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (3, 760, '1955-02-28', '1976-02-26', 1683, 601 , 3, 'SANZ, LAVINIA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (1, 250, '1959-10-29', '1980-03-02', 2705, NULL, 0, 'ALBA, ADRIANA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (1, 220, '1956-12-04', '1981-07-14', 4327, NULL, 6, 'LOPEZ, ANTONIO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (4, 800, '1958-05-23', '1979-09-12', 2284, 481 , 3, 'GARCIA, OCTAVIO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (8, 410, '1961-01-12', '1984-10-09', 1743, NULL, 5, 'FLOR, DOROTEA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (7, 620, '1962-10-27', '1981-02-16', 2284, NULL, 0, 'POLO, OTILIA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (5, 910, '1960-12-01', '1981-02-15', 1623, NULL, 3, 'GIL, GLORIA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (8, 480, '1959-11-23', '1984-01-17', 2524, NULL, 0, 'GARCIA, AUGUSTO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (7, 620, '1970-12-27', '1991-02-07', 2434, NULL, 2, 'SANZ, CORNELIO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (4, 850, '1961-08-21', '1985-03-03', 1683, 541 , 0, 'DIEZ, AMELIA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (7, 610, '1962-04-15', '1997-09-12', 2705, NULL, 1, 'CAMPS, AURELIO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (3, 750, '1971-10-31', '1994-10-12', 1503, 601 , 2, 'LARA, DORINDA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (6, 360, '1980-06-23', '2000-01-03', 1142, NULL, 1, 'RUIZ, FABIOLA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (4, 880, '1981-04-01', '2001-01-02', 1082, NULL, 0, 'MARTIN, MICAELA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (2, 500, '1979-02-21', '1999-10-10', 1292, NULL, 1, 'MORAL, CARMEN');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (3, 780, '1982-08-20', '2000-11-02', 1112, NULL, 0, 'LARA, LUCRECIA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (7, 660, '1981-07-16', '2001-10-15', 1052, NULL, 0, 'MUÑOZ, AZUCENA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (8, 450, '1979-10-24', '2001-11-21', 2404, NULL, 0, 'FIERRO, CLAUDIA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (7, 650, '1980-10-27', '2001-11-21', 1262, NULL, 1, 'MORA, VALERIANA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (3, 760, '1979-09-28', '1999-03-02', 1262, 601 , 0, 'DURAN, LIVIA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (4, 880, '1979-10-23', '1999-03-02', 1262, 601 , 0, 'PEREZ, SABINA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (3, 760, '1978-04-06', '1999-03-02', 1262, 601 , 1, 'PINO, DIANA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (4, 880, '1977-06-08', '2001-01-02', 1082, 601 , 0, 'TORRES, HORACIO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (3, 750, '1978-10-10', '2000-01-03', 1202, 601 , 0, 'VAZQUEZ, HONORIA');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (2, 550, '1979-05-06', '1999-11-03', 1202, NULL, 1, 'CAMPOS, ROMULO');
INSERT INTO TEMPLE (NUMDE, EXTEL, FECNA, FECIN, SALAR, COMIS, NUMHI, NOMEM) 
	VALUES (3, 780, '1983-01-12', '2001-01-22', 601 , 721 , 0, 'SANTOS, SANCHO');